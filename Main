from Load import *
pygame.init()
from Classes import *

player=player()
screen = pygame.display.set_mode((1200,800))
screenidentity=1
charselectvar=1
Name = ''
Name_rect = pygame.Rect(215,570,230,35)
color = color_passive
active = False
game_beaten=False
game_beaten_general=False
game_beaten_perfect=False
movingright=0
movingleft=0
playerx=500
playery=400
playerwidth=191
playerheight=64
enemies=[[testenemy1],[],[]] #first is strongship second is fastship and third is buffship

def windowdraw(number):
    number=number
    if number==1:
        screen.fill((0, 0, 0))
        screen.blit(main_screen_bg, [0, 0])
        for i in range(len(mainmenubuttons)):
            mainmenubuttons[i].draw(screen)
    if number==2:
        screen.fill((125,255,255))
        screen.blit(abilityheader, (500, 340))
        screen.blit(maintext,(180,100))
        finishbutton.draw(screen)
        charselectbutton.draw(screen)
        backbutton.draw(screen)
        for i in range(4):
            if charselectvar == i+1:
                if i+1 != 4 or game_beaten == True:
                    for j in range(12):
                        screen.blit(heroes[i][j],charscreencoords[j])
            if charselectvar == 4 and game_beaten == False:
                screen.blit(secretabilitytext, (600, 340))
                screen.blit(scaled_secret_man, (150, 220))
                screen.blit(scaled_secret_shield, (500, 253))
                screen.blit(scaled_secret_icon, (670, 214))
                screen.blit(secretloretext,(500,400))
            if charselectvar==5:
                screen.blit(secretabilitytext, (600, 340))
                screen.blit(scaled_secret_man, (150, 220))
                screen.blit(scaled_secret_shield, (500, 253))
                screen.blit(scaled_secret_icon, (670, 214))
                screen.blit(secretloretext, (500, 400))
                screen.blit(secretselectedtext, (400, 720))


    if number==3:
        screen.fill((0,0,0))
        screen.blit(achievementheader,(310,50))
        screen.blit(achievementsubheader,(210,120))
        if game_beaten == False:
            screen.blit(achievementtext1false, (520,300))
            if game_beaten_general == False:
                screen.blit(achievementtext2false, (520,400))
            if game_beaten_perfect == False:
                screen.blit(achievementtext3false, (520,500))
        if game_beaten == True:
            screen.blit(achievementtext1true,(300,220))
            screen.blit(achievementsubtext1,(470,270))
            if game_beaten_general == True:
                screen.blit(achievementtext2true,(25,370))
                screen.blit(achievementsubtext2, (280,420))
            if game_beaten_perfect == True:
                screen.blit(achievementtext3true,(130,520))
                screen.blit(achievementsubtext3, (275,570))
        backbutton.draw(screen)
    if number==4:
        screen.fill((250,250,250))
        screen.blit(characterpictures[player.character-1],(-20,550))
        screen.blit(abilitypictures[player.character-1],(200,660))
        screen.blit(etext,(310,670))
        if player.character==1:
            player.shield=strongshield(playerx,playery)
            screen.blit(scaled_shield_shield,(playerx,playery))
        if player.character == 2:
            player.shield=healShield(playerx,playery)
            screen.blit(scaled_heal_shield,(playerx,playery))
        if player.character==3:
            player.shield=buisinessshield(playerx,playery)
            screen.blit(scaled_money_shield,(playerx,playery))
        if player.character==4:
            player.shield=attackshield(playerx,playery)
            screen.blit(scaled_mean_shield,(playerx,playery))
        for i in range(len(enemies)):
            for k in range(len(enemies[i])):
                screen.blit(scaled_mean_shield,(enemies[i][k].x,enemies[i][k].y))


running = True

while running:
    for event in pygame.event.get():
        pos = pygame.mouse.get_pos()
        if event.type == pygame.QUIT:
            running = False
        if event.type == pygame.KEYDOWN:
            if active == True:
                if event.key == pygame.K_BACKSPACE:
                    Name = Name[:-1]
                elif event.key== pygame.K_RETURN:
                    active=False
                elif len(Name) < 10:
                    Name += event.unicode
            if event.key==pygame.K_e and screenidentity== 4 and player.charge==100:
                player.shield.ability()
            if screenidentity == 4:
                if event.key == pygame.K_d:
                    movingright = 1
                if event.key == pygame.K_a:
                    movingleft = 1
        if event.type == pygame.KEYUP:
                if event.key == pygame.K_d:
                    movingright = 0
                if event.key == pygame.K_a:
                    movingleft = 0

        if active == False:
            color = color_passive
        else:
            color = color_active
        Namebox = typing_font.render(Name,True,color)
        if event.type == pygame.MOUSEBUTTONDOWN:
            if Name_rect.collidepoint(event.pos):
                active = True
            else:
                active = False
            if startbutton.isOver(pos) and screenidentity == 1:
                screenidentity=2
            if continuebutton.isOver(pos) and screenidentity == 1:
                screenidentity=2
            if quitbutton.isOver(pos) and screenidentity == 1:
                running = False
            if achievementbutton.isOver(pos) and screenidentity == 1:
                screenidentity=3

            if charselectbutton.isOver(pos) and screenidentity == 2 :
                if charselectvar == 4:
                    charselectvar = 0
                if charselectvar==5:
                    charselectvar=0
                charselectvar += 1
            if backbutton.isOver(pos) and screenidentity == 2:
                screenidentity= 1
            if backbutton.isOver(pos) and screenidentity == 3:
                screenidentity= 1
            if finishbutton.isOver(pos) and screenidentity==2 and game_beaten==True:
                player.name=Name
                player.character=charselectvar
                screenidentity= 4
            if finishbutton.isOver(pos) and screenidentity == 2 and game_beaten==False:
                if charselectvar<4:
                    player.name = Name
                    player.character = charselectvar
                    screenidentity = 4
                else:
                    charselectvar=5


        if event.type == pygame.MOUSEMOTION:
            for i in range(len(mainmenubuttons)):
                if mainmenubuttons[i].isOver(pos):
                    mainmenubuttons[i].color = (255,226,68)
                else:
                    mainmenubuttons[i].color = (125,255,255)

            if charselectbutton.isOver(pos):
                charselectbutton.color = (200,200,200)
            else:
                charselectbutton.color = (255,255,255)
            if backbutton.isOver(pos):
                backbutton.color = (200,200,200)
            else:
                backbutton.color = (255,255,255)
            if finishbutton.isOver(pos):
                finishbutton.color = (200,200,200)
            else:
                finishbutton.color = (255, 255, 255)

    if movingright == 1 and (playerx+(playerwidth)) < 1200:
        playerx += 1
    if movingleft == 1 and playerx > 350:
        playerx -= 1
    if screenidentity == 4:
        for i in range(len(enemies)):
            for k in range(len(enemies[i])):
                if enemies[i][k].x + enemies[i][k].width < 1200 and enemies[i][k].direction == "r":
                    enemies[i][k].x += 0.5
                if enemies[i][k].x + enemies[i][k].width >= 1200 and enemies[i][k].direction == "r":
                    enemies[i][k].direction = "l"
                if enemies[i][k].x > 350 and enemies[i][k].direction == "l":
                    enemies[i][k].x -= 0.5
                if enemies[i][k].x <= 350 and enemies[i][k].direction == "l":
                    enemies[i][k].direction = "r"

    windowdraw(screenidentity)
    if screenidentity == 2:
        Name_rect.w = max(230,Namebox.get_width()+10)
        screen.blit(Namebox, (Name_rect.x+5,Name_rect.y))
        pygame.draw.rect(screen,color,Name_rect,2)
    pygame.display.update()
